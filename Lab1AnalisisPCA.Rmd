---
title: "Lab1AnalisisPCA"
author: "Ayleen Rubio 19003, Andrés Say 19705"
date: "23/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#"C:/Users/andre/OneDrive/Documentos/3er año/2do semestre/Data science/Lab1DS"
knitr::opts_knit$set(root.dir="C:/Users/andre/OneDrive/Documentos/3er año/2do semestre/Data science/Lab1DS")

library(ggplot2)
```

# Laboratorio No. 1: Análisis exploratorio PCA y Apriori

## Análisis Exploratorio

A continuación se mostrará un resumen de cada una de las variables y el tipo 
```{r analisis, echo=FALSE}
library(rela)
library(psych)
library(FactoMineR)
library(fpc)
library(factoextra)
library(arules)
library(corrplot)

datosCasas <- read.csv("train.csv")
summary(datosCasas)
str(datosCasas)
table(unlist(lapply(datosCasas, class)))
```

Con esto puede observarse que, del total de variables con las que cuenta nuestra base de datos, 43 son de tipo character y 38 son de tipo integer, siendo una de ellas el id por lo que no será utilizado en el futuro para formar grupos. 

De estas variables se ha considerado que algunas de ellas valen la pena estudiarlas más a fondo para conocer las condiciones de los datos con los que se llevará a cabo el entrenamiento y las pruebas.

A continuación se explicará la distribución de las variables y su comportamiento:


### Metros cuadrados por lote
```{r grfBldngCss, echo=FALSE}
barplot(datosCasas$LotArea, xlab= "Lote", ylab = "Metros cuadrados", main="Tamaño del lote en metros cuadrados")
```

En este caso, puede observarse que la mayoría de casas se encuentra debajo de los 50,ooo metros cuadrados y que la casa que cuenta con mayor área de lote cuenta con más de 200,000 metros cuadrados.

### Precio de venta
```{r echo=FALSE}
plot(x = datosCasas$LotArea, y= datosCasas$SalePrice, xlab= "Tamaño del lote", ylab= "Precio de venta", main = "Correlación entre tamaño del lote y precio de la casa")
abline(lm(datosCasas$SalePrice ~ datosCasas$LotArea), col = "red")
```

Puede observarse que no existe correlación entre el precio de la casa y el tamaño del lote, esto ya que la mayoría de valores se encuentran antes de los 50,000 metros cuadrados y el precio de venta cambia alrededor de los mismos tamaños de lote, además, las casas a mayor precio se encuentran entre los tamaño de lote menores.

### Año de construcción
```{r echo=FALSE}
df <- as.data.frame(datosCasas$YearBuilt)
anio_construccion <-datosCasas$YearBuilt
mostrar <- ggplot(data=df, aes(x=anio_construccion)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Año de construcción"))
```

En este gráfico puede observarse que los años en los que más hubo construcción de casas ha sido de 1990 a 2000

```{r echo=FALSE}
plot(x = datosCasas$YearBuilt, y= datosCasas$SalePrice, xlab= "Año de construccion", ylab= "Precio de venta", main = "Correlación entre precio de la casa y su año de construccion")
abline(lm(datosCasas$SalePrice ~ datosCasas$YearBuilt), col = "red")
```

Como puede observarse, sí existe una correlación entre el año de construcción y el precio de la casa, ya que puede observarse cómo es que los valores de precio van aumentando a medida que los años van incrementando.

### Metros cuadrados por sótano
```{r echo=FALSE}
df <- as.data.frame(datosCasas$TotalBsmtSF)
metros_cuadrados_sotano <-datosCasas$TotalBsmtSF
mostrar <- ggplot(data=df, aes(x=metros_cuadrados_sotano)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Metros cuadrados del sótano"))
plot(x = datosCasas$TotalBsmtSF, y= datosCasas$SalePrice, xlab= "Total de metros cuadrados del sotano", ylab= "Precio de venta", main = "Correlación entre precio de venta y total de metros cuadrados del sotano")
abline(lm(datosCasas$SalePrice ~ datosCasas$TotalBsmtSF), col = "red")
```

Según lo observado, a pesar que se cuente con lagunos puntos atipicos, sí existe una correlación entre el precio de venta y el total de metros cuadrados del area del sotano.
En este caso, los puntos atípicos representan que hay casas que no cuentan con un sótano tan grande y que, sin embargo, el precio de estas es bastante elevado.

### Metros cuadrados por primer piso
```{r echo=FALSE}
df <- as.data.frame(datosCasas$X1stFlrSF)
metros_cuadrados_primer_piso <- datosCasas$X1stFlrSF
mostrar <- ggplot(data=df, aes(x=metros_cuadrados_primer_piso)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Metros cuadrados del primer piso"))
plot(x = datosCasas$X1stFlrSF, y= datosCasas$SalePrice, xlab= "Total de mestros cuadrados del primer piso", ylab= "Precio de venta", main = "Correlación entre precio de venta y total de metros cuadrados \n del primer piso")
abline(lm(datosCasas$SalePrice ~ datosCasas$X1stFlrSF), col = "red")
```

Puede observarse que sí existe correlación entre el total de metros cuadrados del primer piso y el precio de venta. En este caso los puntos atípicos que pueden observarse representan, al igual que con los metros cuadrados del sótano, existen casas que no cuentan con un primer piso tan grande y aún así tienen un precio elevado.

### Metros cuadrados por segundo piso
```{r echo=FALSE}
df <- as.data.frame(datosCasas$X2ndFlrSF)
metros_cuadrados_segundo_piso <- datosCasas$X2ndFlrSF
mostrar <- ggplot(data=df, aes(x=metros_cuadrados_segundo_piso)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Metros cuadrados segundo piso"))
plot(x = datosCasas$X2ndFlrSF, y= datosCasas$SalePrice, xlab= "Total de mestros cuadrados del segundo piso", ylab= "Precio de venta", main = "Correlación entre precio de venta y total de metros cuadrados \n del segundo piso")
abline(lm(datosCasas$SalePrice ~ datosCasas$X2ndFlrSF), col = "red")
```

En este caso, los valores que cuentan con 0 metros cuadrados en el segundo piso hacen referencia a las casas que no cuentan con un segundo piso, por lo que, si no se toman en cuenta esos valores, sí existe correlación entre los metros cuadrados del segundo piso y el precio de venta de la casa, a pesar de que sea baja.

### Habitaciones sobre el suelo
```{r echo=FALSE}
df <- as.data.frame(datosCasas$BedroomAbvGr)
habitaciones <- datosCasas$BedroomAbvGr
mostrar <- ggplot(data=df, aes(x=habitaciones)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Cuartos"))
plot(x = datosCasas$BedroomAbvGr, y= datosCasas$SalePrice, xlab= "Total de habitaciones sobre el suelo", ylab= "Precio de venta", main = "Correlación entre precio de venta y total de habitaciones sobre el suelo")
abline(lm(datosCasas$SalePrice ~ datosCasas$BedroomAbvGr), col = "red")
```

La mayoría de casas cuenta con 3 cuartos sobre el nivel del suelo. Puede observarse también que no existe correlación entre la cantidad de cuartos y el precio de venta, ya que las casas que cuentan con más cuartos se encuentran entre los precios de venta más bajos.

### Cuartos sobre el suelo
```{r echo=FALSE}
df <- as.data.frame(datosCasas$TotRmsAbvGrd)
total_cuartos <- datosCasas$TotRmsAbvGrd
mostrar <- ggplot(data=df, aes(x=total_cuartos)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Total de cuartos"))
plot(x = datosCasas$TotRmsAbvGrd, y= datosCasas$SalePrice, xlab= "Total de cuartos sobre el suelo", ylab= "Precio de venta", main = "Correlación entre precio de venta y total de cuartos sobre el suelo")
abline(lm(datosCasas$SalePrice ~ datosCasas$TotRmsAbvGrd), col = "red")
```

Puede observarse que en total de cuartos, sin tomar en cuenta los baños completos, la mayoría de casas cuenta con 6 cuartos. A su vez, puede observarse que este dato sí tiene correlación con el precio de venta, ya que a medida que va aumentando la cantidad de cuartos, va aumentando el precio de venta.

### Tamaño del garage respecto a la capacidad de carros
```{r echo=FALSE}
df <- as.data.frame(datosCasas$GarageCars)
garage_carros <- datosCasas$GarageCars
mostrar <- ggplot(data=df, aes(x=garage_carros)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Tamaño del garage en cantidad de carros"))
plot(x = datosCasas$GarageCars, y= datosCasas$SalePrice, xlab= "Tamaño del garage en capacidad de carros", ylab= "Precio de venta", main = "Correlación entre precio de venta y tamaño del carage en capacidad de carros")
abline(lm(datosCasas$SalePrice ~ datosCasas$GarageCars), col = "red")
```

Puede observarse que la mayoría de casas tiene un garage con una capacidad de dos carros, al igual que existe una correlación entre este dato y el precio de venta, ya que a mayor cantidad de carros que entran en un garage, mayor precio de venta.

### Area de madera fuera de cada casa
```{r echo=FALSE}
df <- as.data.frame(datosCasas$WoodDeckSF)
area_madera <- datosCasas$WoodDeckSF
mostrar <- ggplot(data=df, aes(x=area_madera)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Área exterior de madera"))
plot(x = datosCasas$WoodDeckSF, y= datosCasas$SalePrice, xlab= "Area de madera", ylab= "Precio de venta", main = "Correlación entre precio de venta y area de madera")
abline(lm(datosCasas$SalePrice ~ datosCasas$WoodDeckSF), col = "red")
```

Todos los valores en cero pueden ser interpretados como las casas que no cuentan con un área de madera, luego al observar los demás valores, se considera que existen demasiados valores atípicos por lo que no hay correlación entre el área de madera y el precio de venta.

### Area de porche abierto
```{r echo=FALSE}
df <- as.data.frame(datosCasas$OpenPorchSF)
porche_abierto <- datosCasas$OpenPorchSF
mostrar <- ggplot(data=df, aes(x=porche_abierto)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Área de porche abierto"))
plot(x = datosCasas$OpenPorchSF, y= datosCasas$SalePrice, xlab= "Area de porche abierto", ylab= "Precio de venta", main = "Correlación entre precio de venta y area de porche abierto")
abline(lm(datosCasas$SalePrice ~ datosCasas$OpenPorchSF), col = "red")
```

Todos los valores en cero pueden ser interpretados como las casas que no cuentan con área de porche abierto, luego al observar los demás valores, se considera que existen demasiados valores atípicos por lo que no hay correlación entre el área de porche abierto y el precio de venta.

### Area de porche cerrado
```{r echo=FALSE}
df <- as.data.frame(datosCasas$EnclosedPorch)
porche_cerrado <- datosCasas$EnclosedPorch
mostrar <- ggplot(data=df, aes(x=porche_cerrado)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Área de porche cerrado"))
plot(x = datosCasas$EnclosedPorch, y= datosCasas$SalePrice, xlab= "Area de porche cerrado", ylab= "Precio de venta", main = "Correlación entre precio de venta y area de porche cerrado")
abline(lm(datosCasas$SalePrice ~ datosCasas$EnclosedPorch), col = "red")
```

Todos los valores en cero pueden ser interpretados como las casas que no cuentan con área de porche cerrado, luego al observar los demás valores, se considera que existen demasiados valores atípicos por lo que no hay correlación entre el área de porche cerrado y el precio de venta.

### Area de porche con ventana
```{r echo=FALSE}
df <- as.data.frame(datosCasas$ScreenPorch)
porche_ventana <- datosCasas$ScreenPorch
mostrar <- ggplot(data=df, aes(x=porche_ventana)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Área de porche con ventana"))
plot(x = datosCasas$ScreenPorch, y= datosCasas$SalePrice, xlab= "Area de porche con ventana", ylab= "Precio de venta", main = "Correlación entre precio de venta y area de porche con ventana")
abline(lm(datosCasas$SalePrice ~ datosCasas$ScreenPorch), col = "red")
```

Todos los valores en cero pueden ser interpretados como las casas que no cuentan con área de porche con ventana, luego al observar los demás valores se considera que existen demasiados valores atípicos por lo que no hay correlación entre el área de porche con ventana y el precio de venta.

### Area de piscina
```{r echo=FALSE}
df <- as.data.frame(datosCasas$PoolArea)
area_piscina <- datosCasas$PoolArea
mostrar <- ggplot(data=df, aes(x=area_piscina)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Área de piscina"))
plot(x = datosCasas$PoolArea, y= datosCasas$SalePrice, xlab= "Area de piscina", ylab= "Precio de venta", main = "Correlación entre precio de venta y area de piscina")
abline(lm(datosCasas$SalePrice ~ datosCasas$PoolArea), col = "red")
```

Todos los valores en cero pueden ser interpretados como las casas que no cuentan con área de piscina, luego al observar los demás valores se considera que no existen suficientes datos para determinar que sí existe correlación entre el área de piscina y el precio de venta.

### Mes de venta
```{r echo=FALSE}
df <- as.data.frame(datosCasas$MoSold)
mes_venta <- datosCasas$MoSold
mostrar <- ggplot(data=df, aes(x=mes_venta)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Mes de venta"))
plot(x = datosCasas$MoSold, y= datosCasas$SalePrice, xlab= "Mes de venta", ylab= "Precio de venta", main = "Correlación entre precio de venta y mes de venta")
abline(lm(datosCasas$SalePrice ~ datosCasas$MoSold), col = "red")
```

Puede observarse que han habido más ventas durante el mes de junio, sin embargo, no existe correlación entre el mes de venta y el precio de venta.

### Año de venta
```{r echo=FALSE}
df <- as.data.frame(datosCasas$YrSold)
ano_venta <- datosCasas$YrSold
mostrar <- ggplot(data=df, aes(x=ano_venta)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Año de venta"))
plot(x = datosCasas$YrSold, y= datosCasas$SalePrice, xlab= "Año de venta", ylab= "Precio de venta", main = "Correlación entre precio de venta y año de venta")
abline(lm(datosCasas$SalePrice ~ datosCasas$YrSold), col = "red")
```

Puede observarse que han habido más ventas durante el 2009, sin embargo, no existe correlación entre el año de venta y el precio de venta.

### Altura del sotano
```{r echo=FALSE}
df <- as.data.frame(datosCasas$BsmtQual)
altura_sotano <-datosCasas$BsmtQual
mostrar <- ggplot(data=df, aes(x=altura_sotano)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Altura del sótano"))
```

Con esta variable se evalúa la altura del sótano, en donde la mayoría cuenta con una altura típica ded 80 - 89 pulgadas.

### Cantidad de baños completos en los sotanos
```{r echo=FALSE}
mytable<-table(datosCasas$BsmtFullBath)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$BsmtFullBath)
banios_completos_sotano <- datosCasas$BsmtFullBath
mostrar <- ggplot(data=df, aes(x=banios_completos_sotano)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Baños completos en sótano"))
```

En la cantidad de baños completos en el sótano, se cuentan con las opciones desde no contar con uno y como máximo contar con 3. Puede observarse que es más común que no se cuente con baños completos en los sótanos.

### Cantidad de baños completos
```{r echo=FALSE}
mytable<-table(datosCasas$FullBath)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$FullBath)
banios_completos<- datosCasas$FullBath
mostrar <- ggplot(data=df, aes(x=banios_completos)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Baños completos"))
```

En este caso se evalúa la cantidad de baños completos en toda la casa, no únicamente en el sótano, y de la misma manera se cuenta con las opciones desde que no se cuente con baños completos hasta contar con un máximo de 3. En la mayoría de casas se cuenta con 2 baños completos, sin tomar en cuenta los baños del sótano.

### Cantidad de medios baños
```{r echo=FALSE}
mytable<-table(datosCasas$HalfBath)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$HalfBath)
medios_banios <- datosCasas$HalfBath
mostrar <- ggplot(data=df, aes(x=medios_banios)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Medios baños"))
```

En este caso se evalúa la cantidad de medios baños en toda la casa y se cuenta con las opciones desde que no se cuente con medios baños hasta contar con un máximo de 2.La mayoría de casas no cuenta con medios baños.

### Cantidad de chimeneas
```{r echo=FALSE}
mytable<-table(datosCasas$Fireplaces)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$Fireplaces)
chimeneas <- datosCasas$Fireplaces
mostrar <- ggplot(data=df, aes(x=chimeneas)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Chimeneas"))
```

Al evaluar la cantidad de chimeneas con las que se cuenta en las casas, existe la posibilidad de que no se cuente con ninguna o que se cuente como máximo con 3. En la mayoría de las casas no se cuenta con chimeneas, sin embargo, es poca la diferencia con la cantidad de casas que cuentan con una chimenea.

### Proximidad
```{r echo=FALSE}
mytable<-table(datosCasas$Condition1)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$Condition1)
proximidad_condiciones <-datosCasas$Condition1
mostrar <- (ggplot(data=df, aes(x=proximidad_condiciones)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal())
print(mostrar + ggtitle("Proximidad respecto a condiciones"))
```

En cuanto a la proximidad, se tiene la siguiente distribución:
Artery: Adyacente a una calle arterial
Feedr: Adyacente a una calle de alimentación
Norm: Normal
RRNn: A 200' del ferrocarril norte-sur
RRAn: Junto al ferrocarril norte-sur
PosN: Cerca de un parque, cinturón verde, etc.
PosA: Junto a una característica externa positiva
RRNe: A 200' del ferrocarril este-oeste
RRAe: Adyacente al ferrocarril este-oeste

Entre todas las posibles proximidades, puede observarse que la proximidad más común es la normal.

### Tipo de vivienda
```{r echo=FALSE}
mytable<-table(datosCasas$HouseStyle)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$HouseStyle)
tipo_vivienda <-datosCasas$HouseStyle
mostrar <- (ggplot(data=df, aes(x=tipo_vivienda)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal())
print(mostrar + ggtitle("Tipo de vivienda"))
```

En este caso se habla del estilo de vivienda, puede haber viviendas de un piso, casas en las que el segundo piso sea considerado como medio y que este se encuentre terminado o no terminado, de la misma con dos pisos. También se cuenta con casas de vestíbulo dividido y con casas de piso dividido. Puede observarse cómo es que el tipo de vivienda más común es el de un solo nivel, seguido por las casas de 2 niveles.

### Estilo de vivienda
```{r echo=FALSE}
mytable<-table(datosCasas$BldgType)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$BldgType)
estilo_vivienda <- datosCasas$BldgType
mostrar <- (ggplot(data=df, aes(x=estilo_vivienda)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal())
print(mostrar + ggtitle("Estilo de vivienda"))
```

En el estilo de vivienda se estudia la cantidad de familias que ocupan la casa. De la misma manera, puede observarse que los estilos de viviendas más comunes son para una sola familia.

### Materiales y acabados generales
```{r echo=FALSE}
mytable<-table(datosCasas$OverallQual)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$OverallQual)
calidad_materiales_y_acabados <- datosCasas$OverallQual
mostrar1 <- ggplot(data=df, aes(x=calidad_materiales_y_acabados)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar1 + ggtitle("Materiales y acabados generales"))
mytable<-table(datosCasas$OverallCond)
mytable
prop.table(mytable)
df2 <- as.data.frame(datosCasas$OverallCond)
condicion_casa <-datosCasas$OverallCond
mostrar2 <- ggplot(data=df2, aes(x=condicion_casa)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar2 + ggtitle("Condiciones generales"))
```

Al estudiar los materiales, acabado y condiciones se estudia su calidad de 1 a 10 y de 1 a 5 respectivamente.
En estos gráficos puede observarse que tanto los materiales, acabado y condidiones generales de las casas se encuentran en promedio en un valor de 5 de 10.

### Condicion del sotano
```{r echo=FALSE}
mytable<-table(datosCasas$BsmtCond)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$BsmtCond)
condicion_sotano <-datosCasas$BsmtCond
mostrar <- ggplot(data=df, aes(x=condicion_sotano)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Condicion del sótano"))
```

En las condiciones del sótano se cuenta con las siguientes posibilidades:
Ex: Excelente
Gd: Bueno
TA: Típico
Fa: Justo
Po: Pobre
NA: No hay sotano

Podemos observar que la mayoría de los sótanos se encuentra en una condición típica, con un poco de humedad, seguido por una buena condición.

### Exposicion del sotano
```{r echo=FALSE}
mytable<-table(datosCasas$BsmtExposure)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$BsmtExposure)
exposicion_sotano <-datosCasas$BsmtExposure
mostrar <- ggplot(data=df, aes(x=exposicion_sotano)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Exposición del sótano"))
```

En este caso, se representa los muros del sótano a nivel de jardín o si existe un espacio suficiente para tener una salida directa del sótado al jardín, dividiéndose de la siguiente manera:
Gd: buena exposicicon
Av: exposicion promedio
Mn: mínima exposicion
No: no hay exposición
NA: no hay sótano

En este caso la mayoría no cuenta con espacio suficiente para tener una puerta directa hacia el jardín.

### Tipo de calefaccion
```{r echo=FALSE}
mytable<-table(datosCasas$Heating)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$Heating)
calefaccion <- datosCasas$Heating
mostrar <- ggplot(data=df, aes(x=calefaccion)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Tipo de calefacción"))
```

Los tipos de calefacción se dividen en los siguientes:
Floor: horno de piso 
GasA: horno de aire caliente forzado a gas
GasW: calefaccion de agua caliente o vapor a gas
Grav: horno de gravedad
OthW: calefacción por agua caliente o vapor que no sea de gas
Wall: Horno de pared

Puede observarse que el tipo de calefacción más común es el horno de aire caliente forzado a gas.

### Tipo de sistema electrico
```{r echo=FALSE}
mytable<-table(datosCasas$Electrical)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$Electrical)
sistema_electrico <- datosCasas$Electrical
mostrar <- ggplot(data=df, aes(x=sistema_electrico)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Tipo de sistema eléctrico"))
```

En la mayoría de hogares se cuenta con us sistemaeléctrico de disyuntores estándar y Romex

### Cantidad de cocinas sobre el suelo (sin contar cocinas en los sotanos)
```{r echo=FALSE}
mytable<-table(datosCasas$KitchenAbvGr)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$KitchenAbvGr)
cocinas <- datosCasas$KitchenAbvGr
mostrar <- ggplot(data=df, aes(x=cocinas)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Cocinas"))
```

En cuanto a la cantidad de cocinas sobre el suelo, es decir, la cantidad total de cocinas sin tomar en cuenta aquellas que se encuentran en el sótano, puede haber 1 o 2 cocinas. La mayoría de casas cuenta únicamente con una cocina sobre el nivel del suelo.

### Calidad de las cocinas
```{r echo=FALSE}
mytable<-table(datosCasas$KitchenQual)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$KitchenQual)
calidad_cocinas <- datosCasas$KitchenQual
mostrar <- ggplot(data=df, aes(x=calidad_cocinas)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Calidad de las cocinas"))
```

La calidad de las cocinas se divide en lo siguiente: 
Ex: Excelente
Gd: Buena
TA: Típica
Fa: justo
Po: pobre
En este gráfico puede observarse que la calidad de las cocinas es típica o promedio.

### Tipo de venta
```{r echo=FALSE}
mytable<-table(datosCasas$SaleType)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$SaleType)
tipo_venta <- datosCasas$SaleType
mostrar <- ggplot(data=df, aes(x=tipo_venta)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Tipo de venta"))
```

Entre los tipos de ventas se encuentran los siguientes: 
WD: Escritura de garantía - convencional
CWD: Escritura de garantía - dinero en efectivo
VWD: Escritura de garantía - Préstamo VA
New: Casa recién costruida y vendida
COD: Oficial de la corte o estado
Con: Contrato 15% de pago inicial en términos regulares
ConLw: Contrato de bajo pago inicial y bajo interés
ConLI: Contrato de bajo interés
ConLD: Contrato de baja cuota inicial
Oth: otro

Puede observarse que el tipo de venta más común es el convencional con una escritura de garantía.

### Condicion de venta
```{r echo=FALSE}
mytable<-table(datosCasas$SaleCondition)
mytable
prop.table(mytable)
df <- as.data.frame(datosCasas$SaleCondition)
condicion_venta <- datosCasas$SaleCondition
mostrar <- ggplot(data=df, aes(x=condicion_venta)) + geom_bar(stat="count", width=0.7, fill = "steelblue")+theme_minimal()
print(mostrar + ggtitle("Condición de venta"))
```

Entre las condiciones de venta se encuentran las siguientes:
Normal: venta normal
Abnorml: venta normal - comercio, ejecución hipotecaria, venta al descubierto
AdjLand: compra de terreno contiguo
Alloca: adjudicación - dos propiedades vinculadas con escrituras separadas, normalmente un condominio con una unidad de garaje
Family: venta entre miembros de la familia
Partial: la vivienda no estaba terminada cuando se evaluó por última vez (asociada a viviendas nuevas)
Por último, puede observarse que la condición de venta más común es una venta normal.


# PCA

Debido a la gran cantidad de variables y datos el procesamiento y estudio de datos se vuelve algo tedioso y complicado, por lo tanto, se propone realizar pruebas para evaluar la viabilidad de un análisis de componentes principales.
```{r PCA Cor, echo=FALSE}
#Se trabajará con las variables numéricas
#datosCasas[,-c(1,3,6,7,8,9,10,11,12,13,14,15,16,17,22,23,24,25,26,28,29,30,31,32,33,34,36,40,41,42,43,54,56,58,59,61,64,65,66,73,74,75,79,80)]
h<-datosCasas[,-c(1,3,6,7,8,9,10,11,12,13,14,15,16,17,22,23,24,25,26,28,29,30,31,32,33,34,36,40,41,42,43,54,56,58,59,61,64,65,66,73,74,75,79,80)]
h<-h[complete.cases(h),]

dataCor<-cor(h,use = "pairwise.complete.obs")
det(dataCor)
```
El determinante es un valor sumamente pequeño muy próximo a 0, por lo tanto indica que existe multicolinealidad

```{r Analisis factorial, echo=FALSE}
#pafDatos<-paf(as.matrix(h))
#error in solve default(x) : sistema es computacionalmente singular: número de condición recíproco = 2.96373e-18
```
-error in solve default(x) : sistema es computacionalmente singular: número de condición recíproco = 2.96373e-18

Debido a que el determinante es extremadamente cercano a 0, el sistema es computacionalmente singular y por lo tanto no se puede invertir para realizar la prueba, esto se da debido a una dependencia lieneal entre las columnas, por lo que existen variables fuertemente relacionadas, para ejemplificar mejor esto, se procederá a utilizar una prueba de esfericidad de Barlett en donde se tiene lo siguiente:
  Ho: La matriz de correlaciones es igual a la matriz identidad
Ha: la matriz de correlaciones es diferente a la matriz identidad

```{r Esfericidad de Barlett, echo=FALSE}
cortest.bartlett(datosCasas[,-c(1,3,6,7,8,9,10,11,12,13,14,15,16,17,22,23,24,25,26,28,29,30,31,32,33,34,36,40,41,42,43,54,56,58,59,61,64,65,66,73,74,75,79,80)])
```
Debido a que el valor p es 0 (valor teórico) esto implica que es menor a la signficancia (0.05), por lo tanto se rechaza la hipótesis nula y se acepta que la matriz de correlaciones es diferente a la matiz identidad, lo que implica que si parece ser conveniente realizar un PCA para disminuir mis variables.

```{r matriz general Cor, echo=FALSE}
corMatrix<-cor(h,use = "pairwise.complete.obs")
corrplot(corMatrix, method = 'square')
```
Para observar rapidamente la correlaciones entre variables se hace un gráfico en donde la intensidad del color indica que tan interelacionados están los componentes, es evidente que existen varias variables que muestran estar fuertemente relacionados entre sí, por lo que tambien indica que un análisis de componentes es factible.

Para comenzar formalmente el análisis se deben de normalizar los datos para poder escalarlos.
```{r normalización, echo=FALSE}
data<-prcomp(h, scale = T)
data
```

```{r resumen norm, echo=FALSE}
summary(data)
```
en el resúmen observando la proporción acumulativa podemos determinar hasta que componentes tenemos una explicación razonable. En el componente 17 (reduciendo hasta 20) se obtiene una aexplicación de la varianza de hasta el 80% mientras que en el componente 22 (reduciendo hasta 15) se explica hasta el 90%
  
  ```{r obtenerPCA, echo=FALSE}
pca<-PCA(h,ncp=ncol(h), scale.unit = T)
summary(pca)
```
En el gráfico de variables se puede ver la representación de las mismas en las primeras dos dimensiones y en que regiones pueden ser agrupadas por una fuerte correlación. También se observa en el output los valores propios y representación en cada dimensión que se verá mejor en los gráficos a continuación.
```{r graficos de análisis, echo=FALSE}
fviz_eig(data, addlabels = TRUE, ylim = c(0, 90))
fviz_eig(data, addlabels = TRUE, choice = c("eigenvalue"), ylim = c(0, 3))

```
En el primer gráfico se observa la explicación acumulativa de la varianza en cada dimensión, a pesar de que de la primera dimensión hay una disminución significativa, podemos observar con cuales se pueden trabajar de mejor manera en el segundo gráfico, en donde si el valor propio es mayor a 1 entonces si se debe de utilizar. Anteriormente se había establecido que para poder explicar más de 80% de la varianza se deben de utilizar como mínimo 17 componentes principales.

```{r, echo=FALSE}
fviz_pca_var(pca, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)
```

En este gráfico se puede ver la calidad de representación de cada variable en las primeras dos dimensiones, se ve que muchas de ellas se pueden agrupar. Adicionalmente 18 variables no se encuentran representadas en el gráfico por superposición con otras, lo que implica que hay una muy alta correlación de la cuál se puede aprovechar para disminuir dimensiones.

```{r corplot dimensiones, echo=FALSE}
var<-get_pca_var(data)
corrplot(var$cos2, is.corr = F)
```
En este gráfico se puede observar la contribución de cada variable en cada dimensión. Ya habiendo observado la contribución acumulativa y ahora el gráfico se puede concluir que se puede explicar suficiente varianza utilizando 17 dimensiones ya que se llega al 80% y las demás dimensiones contribuyen con muy poco.
# Representación de cada dimensión
```{r dimensión 1, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 1, top = 15) 
```
Las variables de esta dimensión que aportan significativamente a la varianza y están correlacionadas se pueden englobar en lujos o comodidades de un hogar en relación a precio cosas particulares de un hogar. Es decir, entre más calidad o más grande el área, el garaje, remodelación etc, más se aporta a la característica de ser más lujoso.

```{r dimensión 2, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 2, top = 15) 
```
En la segunda dimensión se puede observar que las variables que se encuentran sobre el límite se encuentran relacionadas de alguna manera al tamaño del hogar en base a características de construcción, siendo X2ndFlrSF en tamaño del segundo piso, BedrroomAbv es la cantidad de cuartos, tambien está la variable de área, tamaño del balo, sótano etc. 

```{r dimensión 3, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 3, top = 15) 
```
En está dimensión se encuentran varias variables que contienen información referente a remodelación de varios aspectos de la casa y las otras hacia partes particulares de un hogar, como chimeneas, piscina, baños etc.

```{r dimensión 4, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 4, top = 15) 
```
En la dimensión 4 se puede observar que las variables que se encuentran sobre el límite (en su mayoría) tienen información sobre el sótano y su área (SF) en relación al tipo de clase que se puede encontrar en las casas.

```{r dimensión 5, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 5, top = 15) 
```
En la 5ta dimensión se pueden observar que hay 4 variables que dificilmente se encuentran sobre el límite para ser significativos MiscVal hace referancia a características miscelaneas que no son cubiertas por la información general de la casa, las demás características se pueden unificar por ser "extras" de una casa por lo general, como el tamaño de la cocina, fogatas, pórticos y si estos tienden a existir cuando se notifica una remodelación.

```{r dimensión 6, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 6, top = 15) 
```
Las 9 variables que se encuentran sobre el límite de la dimensión 6 son un poco más variadas, 5 de ellas se pueden relacionar por teenr información sobre el pórtico o deck y su tamaño, tomando en cuenta tambien el tamaño del lote completo. Adicionalmente se encuentran otras como la variable de miscelaneos (el precio neto de features extras), la clase, el tamaño de la cocina y baños medios en el sótano, que de cierta manera también se corelacionan por tamaño de características particulares no escenciales de un hogar.

```{r dimensión 7, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 7, top = 15)
```
En la dimensión 8 se pueden notar 3 variables que sobresalen notablemente sobre las demás que (dificilmente) también se encuentran sobre el límite. el mes y año de venta, relacionado con la presencia de caracterísicas del sótano (medio baño, square feets del sótano) y tamaño de la planta baja. que muestran la tendencia de características particulares en un año y mes particulares.

```{r dimensión 8, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 8, top = 15)
```
En la dimensión 8 se encuentran 8 variables sobre el límite. Las variables como el año, presencia de medios baños, tamaño de la cocina, decks e incluso la remodelación se pueden unificar por la mejora de calidad (overallCond) de un hogar luego de que ha sido remodelada.

```{r dimensión 9, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 9, top = 15) 
```
En este caso, el componente parece estar representado por variables que que aportan a la clase de construcción, como el tipo de pórtico, sótano (en relación con la calidad), piscina, cuartos y área neta de la casa. Adicionalmente se puede relacionar a la representatividad que tiene en los meses que es comprada.


```{r dimensión 10, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 10, top = 15) 
```
En la 10ma dimensión tenemos la presencia de variables que representan (en su mayoría) comodidades extras (como en alguno de los componentes anteriores). Tales como una gran área de piscina, tamaño (área) del sótano (por lo tanto presencia de otras características como baño), pórtico (tamaño también) y chimeneas.

```{r dimensión 11, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 11, top = 15) 
```
En esta dimensión hay un variable que tiene gran represantitividad (area en pies del pórtico de 3 estaciones) que generalmente se encuentra en casas grandes, por lo que de cierta manera tenemos otras que aportan al tamaño tales como: área del deck, área del sótano, área de la piscina y miscelaneos (agregan valor)

```{r dimensión 12, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 12, top = 15)
```
En esta dimensión tenemos dos variables que tienen casí la misma contribución, baños medios del sótano y áreas terminadas del sótano (en menor contribución hay baños completos del sótano), por lo que la relación parece ser algo evidente al comienzo, sin embargo luego tenemos mes de venta, pórtico, condición general.

```{r dimensión 13, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 13, top = 15) 
```
En este componente se tienen 6 variables sobre el límite en donde todas, excepto MiscVal hacen referencia al área de diferentes partes del hogar como la planta baja, piscina,diferentes pórticos. Siendo MiscVal el valor de características extras se puede inferir que se debe a que estas casas (mayormente) al tener todas estas variables, tienden a tener presente otras características miscelaneas 

```{r dimensión 14, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 14, top = 15)
```
En el componente 14 se tienen 4 variables que hacen referencia al tamaño del pórtico, sótano, planta baja o pórtico de 3 estaciones. Las otras dos son de clase de construcción y el mes en el que fueron compradas, por lo que puede existir una relación entre el tamaño de características extra que (definitivamente) afecta la lase de construcción y se encuentra relacionada de alguna manera a algún mes en específico en donde hay más probabilidad de ser comprada. 

```{r dimensión 15, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 15, top = 15) 
```
En la 15 dimensión tenemos las variables que hacen alusión a áreas extra del hogar que de estar presentes tienen una relación con la calidad general de la casa.

```{r dimensión 16, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 16, top = 15) 
```
En el componente 16 hay varias variables que se encuentran sobre el límite y por lo tanto dificilmente hay una relación muy particular entre todas, hay variables que describen el área, o el año en el que fue remodelado (mejorando o añadiendo probablemente), por lo que de cierta manera se puede atar con la calidad general de la casa con base en varias características.

```{r dimensión 17, echo=FALSE}
fviz_contrib(data, choice = "var", axes = 17, top = 15) 
```
En esta última componente podemos ver 6 variables sobre el límite de contribución en donde los que más aportan son las variables del año y el mes que fueron vendidos, por lo que las demás condiciones; baño en e sótano, codición general, área de pórtico de 3 estaciones y área de pórtico abierto. Pueden ser características que tienen más probabilidad de ser llamativas en un año en particular o mes (como estaciones del año).

# Reglas de Asociación

```{r formar reglas, echo=FALSE}
str(datosCasas)
#reglas<-apriori(datosCasas, parameter = list(support = 0.2,
                                   #     confidence = 0.70,
                                  #      target = "rules"))
```

# Conclusiones 